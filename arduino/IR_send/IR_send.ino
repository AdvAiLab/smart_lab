/* 
[credit]
http://wyj-learning.blogspot.com/2017/12/arduino-06.html
 */

#include "IRremote.h"

IRsend irsend;// pin 7 for Arduino Due, pin 9 for Arduino Mega, pin 3 for Arduino UNO


const unsigned int Fan_ON[]={
1300, 360, 1300, 360, 430, 1240, 1300, 360, 1300, 360,
430, 1240, 430, 1240, 430, 1240, 430, 1240, 430, 1240,
430, 1240, 1270, 7744, 1300, 360, 1300, 360, 430, 1240,
1300, 360, 1300, 360, 430, 1240, 430, 1240, 430, 1240,
430, 1240, 430, 1240, 430, 1240, 1300, -1
}; // 香格里拉電風扇 turn on

const unsigned int Fan_OFF[]={
1328, 364, 1284, 412, 428, 1252, 1300, 360, 1300, 400,
436, 1240, 464, 1212, 444, 1244, 440, 1236, 1280, 396,
464, 1216, 464, 8564, 1336, 364, 1284, 412, 424, 1256,
1276, 400, 1284, 400, 424, 1252, 452, 1232, 424, 1256,
436, 1240, 1300, 376, 440, 1252, 436, -1
}; // 香格里拉電風扇 turn off

const unsigned int AC_ON[]={
3684, 2376, 672, 600, 644, 1780, 668, 1780, 660, 1780, 
668, 576, 664, 604, 636, 608, 648, 608, 636, 576, 652, 
592, 652, 592, 660, 608, 632, 588, 656, 580, 664, 604, 
648, 608, 632, 1780, 668, 580, 664, 576, 660, 608, 636, 
584, 660, 592, 652, 616, 640, 600, 636, 608, 636, 608, 
636, 1780, 668, 1776, 676, 596, 648, 1776, 668, 1756, 
636, 8652, 3660, 2412, 660, 612, 632, 1780, 668, 1780, 
672, 1780, 668, 604, 640, 576, 660, 608, 636, 584, 660, 
616, 628, 616, 632, 612, 632, 572, 660, 592, 652, 588, 
656, 612, 636, 608, 648, 1780, 656, 588, 652, 616, 636, 
584, 660, 608, 636, 600, 640, 604, 640, 592, 660, 584, 
656, 604, 640, 1780, 660, 1784, 664, 616, 628, 1780, 672, 
1760, 636, -1
}; // 大同冷氣 turn on

const unsigned int AC_OFF[]={
3684, 2376, 672, 600, 644, 1780, 668, 1780, 660, 1780, 668,
576, 664, 604, 636, 608, 648, 608, 636, 576, 652, 592, 652,
592, 660, 608, 632, 588, 656, 580, 664, 604, 648, 608, 632,
1780, 668, 580, 664, 576, 660, 608, 636, 584, 660, 592, 652,
616, 640, 600, 636, 608, 636, 608, 636, 1780, 668, 1776, 676,
596, 648, 1776, 668, 1756, 636, 8652, 3660, 2412, 660, 612, 
632, 1780, 668, 1780, 672, 1780, 668, 604, 640, 576, 660, 608, 
636, 584, 660, 616, 628, 616, 632, 612, 632, 572, 660, 592, 
652, 588, 656, 612, 636, 608, 648, 1780, 656, 588, 652, 616, 
636, 584, 660, 608, 636, 600, 640, 604, 640, 592, 660, 584, 
656, 604, 640, 1780, 660, 1784, 664, 616, 628, 1780, 672, 
1760, 636, -1
}; // 大同冷氣 turn off

int i = 0;
int incomingByte = 'o';

void send_cmd(const unsigned int* cmd) {
  int length = 0;
  while(cmd[length] != -1) {
    length++;
  }
  irsend.sendRaw(cmd, length, 38);
}

void scooter89_sound() {
    int beat_step = i % 11;
    if (beat_step==0) {
      delay(500);
    }else if(beat_step==1) {
      delay(500);
    }else if(beat_step==2) {
      delay(250);
    }else if(beat_step==3) {
      delay(250);
    }else if(beat_step==4) {
      delay(500);
    }else if(beat_step==5) {
      delay(250);
    }else if(beat_step==6) {
      delay(250);
    }else if(beat_step==7) {
      delay(250);
    }else if(beat_step==8) {
      delay(500);
    }else if(beat_step==9) {
      delay(250);
    }else if(beat_step==10) {
      delay(500);
    }
    i++;
}

void setup()
{
  Serial.begin(115200);
}

void loop()
{
  if (Serial.available() > 0) {
    // read the incoming byte:
    incomingByte = Serial.read();
  }
  if(incomingByte != -1) {
    if(incomingByte == 'o') {
      send_cmd(AC_ON);
      delay(1000);
      send_cmd(AC_OFF);
      delay(1000);
    }
  }
}
